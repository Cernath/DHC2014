%script{src: "//maps.google.com/maps/api/js?v=3.13&sensor=false&libraries=geometry", type: "text/javascript"}
%script{src: "//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js", type: "text/javascript"}
%script{src: "//google-maps-utility-library-v3.googlecode.com/svn/trunk/richmarker/src/richmarker-compiled.js", type: "text/javascript"}

.container
  .row
    .col-md-8
      %h1 Carte
      %div{style: "width: 100%; height: 400px;"}
        #map{style: "width: 100%; height: 400px;position: relative; overflow: hidden;"}
    .col-md-4
      %ul.nav.nav-pills.nav-stacked
        %li.active
          %a{href: "#"} 
        %li.active
          %a{href: "#"} 

 
:javascript
  handler = Gmaps.build('Google');
 
  var map = handler.buildMap({ 
      provider: {zoom: 5}, 
      internal: {id: 'map'}
    },
    function() {
       markers =handler.addMarkers(#{@hash.to_json});
       circle = [{lat: 48.5, lng: 7.7, radius: 100000 }]
       circle_options = { 
          strokeColor:"#313131",
          strokeOpacity: .4,
          StrokeWeight: .8,
          strokeWeight: 3,
          fillColor: '#C60800',
          fillOpacity: .6,
          clickable: true,
          
       }
        var infowindow= new google.maps.InfoWindow({
          content: "coucou"
       });
       google.maps.event.addListener(circle, 'click', function(object){ var position_clicked = object.latLng;});
       handler.addCircles(circle, circle_options);
      
       handler.bounds.extendWith(markers);
       handler.map.centerOn({ lat: 48.5, lng: 7.7 }); 
       handler.getMap().setZoom(10);
    }
  ); 